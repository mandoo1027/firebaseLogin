<!DOCTYPE html>  
<html>    
<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-database.js"></script>
 	<script src="fireinit.js"></script>
 	<script type="text/javascript"> 
 	$( document ).ready(function() { 
 			 
 		 
	 		$("#BTN_GOOGLE_LOGIN").click(function(){
				var provider = new firebase.auth.GoogleAuthProvider();
				
				firebase.auth().signInWithPopup(provider).then(function(result){
					$("#AUTH_STATE").text(result.user.displayName + "님 로그인 하셨습니다.");
					fn_showUserInfo(result.user);
	 				$("#BTN_GOOGLE_LOGOUT").show();
					
				}).catch(function(error){
					alert(error.message);
				});
	 		});
	 		
	 		/*인증 상태 변화 감시하기*/
	 		firebase.auth().onAuthStateChanged(function(user){
	 			if(user){ //인증되었을때
	 				$("#AUTH_STATE").text(user.displayName + "님 로그인 하셨습니다.");
	 				$("#BTN_GOOGLE_LOGOUT").show();
	 				fn_showUserInfo(user);
	 			}else{//인증되지 않았을때
	 				$("#AUTH_STATE").text("인증되지 않음");
	 				$("#BTN_GOOGLE_LOGOUT").hide();
	 				$("#USER_INFO").hide();
	 			}
	 		});
	 		
	 		/*로그아웃 버튼*/
	 		$("#BTN_GOOGLE_LOGOUT").click(function(){
	 			firebase.auth().signOut().then(function(){
	 				alert("인증이 헤제되었습니다.");
	 			},function(error){
	 				alert(error.message);
	 			});
	 		});
	 		
 		});
 	
 	function fn_showUserInfo(user){
 		$("#USER_INFO").show();
 		$("#USER_UID").text(user.uid)
		$("#USER_MAIL").text(user.email)
		$("#USER_NAME").text(user.displayName)
		$("#USER_PHOTO").attr('src',user.photoURL)
 	}
 	
 	</script>
</head>

<body>
	<div class="card-content"> 
		<span id="AUTH_STATE">(인증되지않음)</span>
		
		<ol id="USER_INFO" style="display: none">
			<li>UID : <span id="USER_UID"></span></li>
			<li>메일  : <span id="USER_MAIL"></span></li>
			<li>이름 : <span id="USER_NAME"></span></li>
			<li>사진 : <img id="USER_PHOTO"></li>
		
		</ol>
		 
	</div>
	<div class="card-content">
		<button id="BTN_GOOGLE_LOGIN" type="button" class="btn_indigo">구글인증</button>
		<button id="BTN_GOOGLE_LOGOUT" type="button" style="display: none;">인증해제</button>
	</div>
</body>
</html>